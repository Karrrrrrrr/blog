---
title: "字符串哈希与矩阵哈希"
date: "2023-04-18T17:26:51+08:00"
---


## 矩阵哈希
我们对于每个矩阵的哈希记作
$$
\sum_{i=1}^N\sum_{j=1}^Ma_{ij} * k_1 ^ { n - i } * k_2 ^ { m-j }
$$

$k_1$, $k_2$ 分别是行列进制值, 一般取2333, 23333, $a_{ij}$是原矩阵的值

注意点: 涉及到前缀和的计算, 索引一般从1开始,而不是0

$k_1$, $k_2$ 的幂计算需要提前预处理 

那么, 对于一个矩阵右下角为 (x,y), 宽高为(w,h)的矩阵哈希值为
$$
{H}(x,y) + {H}(x-{h} , y-{w}) * {k_1}^{h} * {k_2}^{w} - H(x-{h},y)*k_1^h - H(x,y-{w})*k_{2}^w
$$

题意：给一个矩阵，进行一次询问，询问给定一个矩阵，问询问的矩阵在原矩阵里匹配上了几次。
